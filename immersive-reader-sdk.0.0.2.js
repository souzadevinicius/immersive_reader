!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ImmersiveReader=t():e.ImmersiveReader=t()}(window,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1);t.renderButtons=r.renderButtons;var a=n(2);t.launchAsync=a.launchAsync,window.addEventListener("load",function(){r.renderButtons()})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="data-icon-px-size",a="data-button-style",i="data-locale",o="https://contentstorage.onenote.office.net/onenoteltir/permanent-static-resources/immersive-reader-icon.svg",s={af:"Indompelende leser",am:"á‰ áˆ…á‹«á‹ áˆµáˆœá‰µ áˆáŒ£áˆª á‹•á‹­á‰³ áŠ áŠ•á‰£á‰¢",ar:"Ø§Ù„Ù‚Ø§Ø±Ø¦ Ø§Ù„Ø´Ø§Ù…Ù„",as:"à¦‡à¦®à¦¾à§°à¦šà¦¿à¦­ à§°à¦¿à¦¡à¦¾à§°",az:"Ä°mmersiv Oxuyucu",be:"Ð†Ð¼ÐµÑ€ÑÑ–ÑžÐ½Ñ‹ Ñ‡Ñ‹Ñ‚Ð°Ð»ÑŒÐ½Ñ–Ðº",bg:"ÐšÐ¾Ð½Ñ†ÐµÐ½Ñ‚Ñ€Ð¸Ñ€Ð°Ð½ Ñ‡ÐµÑ‚ÐµÑ†",bn:"à¦®à¦¨à§‹à¦—à§à¦°à¦¾à¦¹à§€ à¦ªà¦¾à¦ à¦•","bn-bd":"à¦‡à¦®à¦¾à¦°à§à¦¸à¦¿à¦­ à¦ªà¦¾à¦ à¦•",bs:"Koncentrirani Äitalac",ca:"Lector immersiu",cs:"AsistivnÃ­ ÄteÄka","cy-gb":"Darllenydd Ymdrwythol",da:"Forenklet lÃ¦ser",de:"Plastischer Reader",el:"Î ÏÎ¿Î·Î³Î¼Î­Î½Î¿ Ï€ÏÏŒÎ³ÏÎ±Î¼Î¼Î± Î±Î½Î¬Î³Î½Ï‰ÏƒÎ·Ï‚",en:"Immersive Reader",es:"Lector inmersivo",et:"SÃ¼valuger",eu:"Irakurgailu murgiltzailea",fa:"Ø®ÙˆØ§Ù†Ù†Ø¯Ù‡ Ù‡Ù…Ù‡â€ŒØ¬Ø§Ù†Ø¨Ù‡",fi:"SyventÃ¤vÃ¤ lukuohjelma",fil:"Immersive Reader",fr:"Lecteur immersif","ga-ie":"LÃ©itheoir tumthach",gd:"An leughadair Ã¹r-nÃ²sach",gl:"Lector avanzado",gu:"àª‡àª®àª°à«àª¸àª¿àªµ àª°à«€àª¡àª°",ha:"Mai karatu Mai barbazawa",he:"×ª×¦×•×’×ª ×§×¨×™××” ×ž×•×“×¨× ×™×ª",hi:"à¤‡à¤®à¤°à¥à¤¸à¤¿à¤µ à¤°à¥€à¤¡à¤°",hr:"Stopljeni ÄitaÄ",hu:"Modern olvasÃ³",hy:"Ô½Õ¸Ö€Õ¡Õ½Õ¸Ö‚Õ¦Õ¾Õ¡Õ® Õ¨Õ¶Õ©Õ¥Ö€ÖÕ«Õ¹",id:"Pembaca Imersif",ig:"á»Œgá»¥á»¥ Kenzipá»¥tara",is:"AÃ°gengilegt lestrarumhverfi",it:"Strumento di lettura immersiva",ja:"ã‚¤ãƒžãƒ¼ã‚·ãƒ– ãƒªãƒ¼ãƒ€ãƒ¼",ka:"áƒ˜áƒ›áƒ”áƒ áƒ¡áƒ˜áƒ£áƒšáƒ˜ áƒ¬áƒáƒ›áƒ™áƒ˜áƒ—áƒ®áƒ•áƒ”áƒšáƒ˜",kk:"Ð˜Ð¼Ð¼ÐµÑ€ÑÐ¸Ð²Ñ‚Ñ– Ð¾Ò›Ñƒ Ò›Ò±Ñ€Ð°Ð»Ñ‹",km:"áž€áž˜áŸ’áž˜ážœáž·áž’áž¸áž¢áž¶áž“áž–ážŽáŸŒážšáŸ†áž›áŸáž…áž“áŸ…áž›áž¾áž¢áŸáž€áŸ’ážšáž„áŸ‹",kn:"à²‡à²®à³à²®à²°à³à²¸à²¿à²µà³ à²“à²¦à³à²—",ko:"ëª°ìž…í˜• ë¦¬ë”",kok:"à¤¤à¤‚à¤¦à¥à¤°à¥€ à¤²à¤¾à¤—à¤¿à¤²à¥à¤²à¥‹ à¤µà¤¾à¤šà¤•","ku-arab":"Ø®ÙˆÛŽÙ†Û•Ø±ÛŒ Ù¾Ú•",ky:"ÐšÑƒÑ€Ñ‡Ð°Ð³Ð°Ð½ ÐžÐºÑƒÐ³ÑƒÑ‡",lb:"Immersive Reader",lo:"àº•àº»àº§àº­à»ˆàº²àº™àº­àº´àº¡à»€àº¡àºµàºªàºµàºš",lt:"Ä®traukianti skaitytuvÄ—",lv:"TÄ«rskata lasÄ«tÄjs",mi:"PÅ«pÄnui Rumaki",mk:"Ð¡ÐµÐ¾Ð¿Ñ„Ð°Ñ‚ÐµÐ½ Ñ‡Ð¸Ñ‚Ð°Ñ‡",ml:"à´‡à´®àµà´®àµ‡à´´àµâ€Œà´¸àµ€à´µàµ à´±àµ€à´¡àµ¼",mn:"Ð˜Ð´ÑÐ²Ñ…Ñ‚ÑÐ¹ ÑƒÐ½ÑˆÐ¸Ð³Ñ‡",mr:"à¤‡à¤®à¤°à¥à¤¸à¤¿à¤µà¥à¤¹ à¤µà¤¾à¤šà¤•",ms:"Pembaca Imersif",mt:"Qarrej Immersiv",ne:"à¤‡à¤®à¥‡à¤°à¥à¤¸à¤¿à¤­ à¤°à¤¿à¤¡à¤°",nl:"Insluitende lezer","nn-no":"Engasjerande lesar",no:"Engasjerende leser",nso:"Go Bala ka Mongwalo o Mokoto",or:"à¬‡à¬®à¬°à¬¸à¬¿à¬­à­ à¬°à¬¿à¬¡à¬°à­",pa:"à¨‡à¨®à¨°à¨¸à¨¿à¨µ à¨°à©€à¨¡à¨°","pa-arab":"Ú¯Ú¾ÛŒØ±Ù† Ø¢Ù„Ø§ Ù…Ø·Ø§Ù„Ø¹Û Ú©Ø§Ø±",pl:"Czytnik immersyjny",prs:"Ø®ÙˆØ§Ù†Ù†Ø¯Ù‡ Ù†Ù…Ø§ÛŒØ´",pt:"Leitura AvanÃ§ada",quc:"Nim ucholajil sik'inel uwach",quz:"Wankisqa Ã‘awiq",ro:"Immersive Reader",ru:"Ð˜Ð¼Ð¼ÐµÑ€ÑÐ¸Ð²Ð½Ð¾Ðµ ÑÑ€ÐµÐ´ÑÑ‚Ð²Ð¾ Ñ‡Ñ‚ÐµÐ½Ð¸Ñ",rw:"Insakazasoma",sd:"Ø§Ù…Ø±Ø³Ùˆ Ø±ÙŠÚŠØ±",si:"à¶œà·’à¶½à·™à¶± à·ƒà·”à·…à·” à¶šà·’à¶ºà·€à¶±à¶º",sk:"ImerznÃ¡ ÄÃ­taÄka",sl:"Potopni bralnik",sq:"Lexuesi kredhÃ«s","sr-cyrl-ba":"ÐšÐ¾Ð½Ñ†ÐµÐ½Ñ‚Ñ€Ð¸ÑÐ°Ð½Ð¸ Ñ‡Ð¸Ñ‚Ð°Ð»Ð°Ñ†","sr-cyrl-rs":"ÐšÐ¾Ð½Ñ†ÐµÐ½Ñ‚Ñ€Ð¸ÑÐ°Ð½Ð¸ Ñ‡Ð¸Ñ‚Ð°Ð»Ð°Ñ†","sr-latn-rs":"Koncentrisani Äitalac",sv:"Avancerad lÃ¤sare",sw:"Kisomaji cha Kuzamisha",ta:"à®…à®±à¯à®ªà¯à®¤à®®à®¾à®© à®°à¯€à®Ÿà®°à¯",te:"à°®à°‚à°¤à±à°°à°®à±à°—à±à°§à±à°²à°¨à± à°šà±‡à°¸à±‡ à°ªà° à°¨ à°¸à°¾à°§à°¨à°‚","tg-cyrl-tj":"Ð¥Ð¾Ð½Ð°Ð½Ð´Ð°Ð¸ Ñ„Ð°Ñ€Ð¾Ð³Ð¸Ñ€",th:"à¹‚à¸›à¸£à¹à¸à¸£à¸¡à¸Šà¹ˆà¸§à¸¢à¸­à¹ˆà¸²à¸™",ti:"áŠ£áŠ•á‰£á‰¢ áˆ•áˆ‰á‹ áˆµáˆá‹’á‰µ áˆáŒ£áˆª",tk:"GiÅˆiÅŸleÃ½in okaÃ½jy",tn:"Sebadi sa Imesife",tr:"Tam Ekran Okuyucu",tt:"Ð§Ð¾Ð»Ð³Ð°Ð¿ Ð°Ð»ÑƒÑ‡Ñ‹ ÑƒÐºÑƒ Ñ‡Ð°Ñ€Ð°ÑÑ‹","ug-cn":"Ú†Û†ÙƒÙ…Û• Ø¦ÙˆÙ‚Û‡ØºÛ‡Ú†",uk:"Ð—Ð°Ð½ÑƒÑ€ÐµÐ½Ð½Ñ Ð² Ñ‚ÐµÐºÑÑ‚",ur:"Ø§Ù…Ø±Ø³ÛŒÙˆ Ù…Ø·Ø§Ù„Ø¹Û Ú©Ø§Ø±",uz:"Immersiv mutolaa vositasi",vi:"TrÃ¬nh Ä‘á»c ChÃ¢n thá»±c",wo:"JÃ ngukaay bu Rafet",xh:"Isifundi Esikhulu",yo:"ÃŒwÃ² AlÃ¡mÃ¹tÃ¡n",zh:"æ²‰æµ¸å¼é˜…è¯»å™¨","zh-hant":"æ²ˆæµ¸å¼é–±è®€ç¨‹å¼",zu:"Isifundi Sokuzizwisa"};function u(e){var t=document.createElement("img");t.src=o;var n=e.getAttribute(r)||"20";t.style.height=t.style.width=n+"px",t.style.verticalAlign="middle",t.style.marginTop="-2px";var a=e.getAttribute(i)||"en";t.alt=c(a),e.appendChild(t)}function d(e){var t=document.createElement("span");t.style.marginLeft="8px",e.appendChild(t)}function l(e){var t=document.createElement("span"),n=e.getAttribute(i)||"en";t.textContent=c(n),e.appendChild(t)}function c(e){return e=e.toLowerCase(),s[e]?s[e]:"zh-hk"===e||"zh-mo"===e||"zh-tw"===e?s["zh-hant"]:(e=e.substring(0,e.lastIndexOf("-")),s[e]?s[e]:(e=e.substring(0,e.lastIndexOf("-")),s[e]?s[e]:s.en))}t.renderButtons=function(e){var t=document.createElement("style");t.innerHTML=".immersive-reader-button{cursor:pointer;display:inline-block;padding:5px;} .immersive-reader-button:hover{background:rgba(0,0,0,.05);border-radius:2px",document.head.appendChild(t);var n=[].slice.call(document.getElementsByClassName("immersive-reader-button"));e&&e.elements&&(n=e.elements);for(var r=0,o=n;r<o.length;r++){var s=o[r];s.setAttribute("type","button"),s.setAttribute("role","button");var m=s.getAttribute(i)||"en";switch(s.setAttribute("aria-label",c(m)),s.getAttribute(a)||"icon"){case"icon":u(s);break;case"text":l(s);break;case"iconAndText":u(s),d(s),l(s)}}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=n(3);t.launchAsync=function(e,t,n,i){return new Promise(function(o,s){if(e)if(n)if(n.chunks)if(n.chunks.length){var u=Date.now();(i=r({uiZIndex:1e3,timeout:15e3,useWebview:!1},i)).uiZIndex&&"number"==typeof i.uiZIndex||(i.uiZIndex=1e3);var d=null,l=document.createElement("div"),c=i.useWebview?document.createElement("webview"):document.createElement("iframe"),m=document.createElement("style");m.innerHTML="body{height:100%;overflow:hidden;}";var f=function(){d&&(window.clearTimeout(d),d=null)},p=function(){document.body.contains(l)&&document.body.removeChild(l),f(),m.parentNode&&m.parentNode.removeChild(m)};p();var v=function(r){if(r&&r.data)if("ImmersiveReader-Exit"===r.data)p(),window.removeEventListener("message",v),i.onExit&&i.onExit();else if("ImmersiveReader-ReadyForContent"===r.data){var d={cogSvcsAccessToken:e,cogSvcsSubdomain:t,request:n,launchToPostMessageSentDurationInMs:Date.now()-u};c.contentWindow.postMessage(JSON.stringify({messageType:"Content",messageValue:d}),"*")}else"ImmersiveReader-LaunchSuccessful"===r.data?(f(),o(l)):"ImmersiveReader-TokenExpired"===r.data?(f(),s({code:a.ErrorCode.TokenExpired,message:"The access token supplied is expired."})):"ImmersiveReader-Throttled"===r.data&&(f(),s({code:a.ErrorCode.Throttled,message:"You have exceeded your quota."}))};window.addEventListener("message",v),d=window.setTimeout(function(){s({code:a.ErrorCode.Timeout,message:"Page failed to load after timeout ("+i.timeout+" ms)"})},i.timeout),c.setAttribute("allowfullscreen",""),c.style.cssText="position: static; width: 100vw; height: 100vh; left: 0; top: 0; border-width: 0",i.useWebview&&c.addEventListener("loadstop",function(){c.contentWindow.postMessage(JSON.stringify({messageType:"WebviewHost"}),"*")});var h="https://learningtools.onenote.com/learningtoolsapp/cognitive/reader?exitCallback=ImmersiveReader-Exit";i.uiLang&&(h+="&omkt="+i.uiLang),c.src=h,l.style.cssText="position: fixed; width: 100vw; height: 100vh; left: 0; top: 0; border-width: 0; -webkit-perspective: 1px; z-index: "+i.uiZIndex+"; background: white; overflow: hidden",l.appendChild(c),document.body.appendChild(l),document.head.appendChild(m)}else s({code:a.ErrorCode.BadArgument,message:"Chunks must not be empty"});else s({code:a.ErrorCode.BadArgument,message:"Chunks must not be null"});else s({code:a.ErrorCode.BadArgument,message:"Content must not be null"});else s({code:a.ErrorCode.BadArgument,message:"Token must not be null"})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.BadArgument="BadArgument",e.Timeout="Timeout",e.TokenExpired="TokenExpired",e.Throttled="Throttled"}(t.ErrorCode||(t.ErrorCode={}))}])});